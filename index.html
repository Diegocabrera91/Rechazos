<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Cheques Rechazados - Cloud Edition</title>
    <!-- Bibliotecas Externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --color-primary: #2B7A8F;
            --color-primary-light: #E8F4F8;
            --color-success: #27AE60;
            --color-danger: #E74C3C;
            --color-warning: #F39C12;
            --color-bg: #F8F9FA;
            --color-border: #DDD;
            --color-text: #333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 100%;
            margin: 0;
            background: white;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, var(--color-primary) 0%, #1e5a6f 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .excel-controls {
            background: #f1f1f1;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid var(--color-border);
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary { background: var(--color-primary); color: white; }
        .btn-success { background: var(--color-success); color: white; }
        .btn-warning { background: var(--color-warning); color: white; }
        .btn-danger { background: var(--color-danger); color: white; }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }

        .tabs { display: flex; background: #eee; }
        .tab-btn {
            flex: 1; padding: 15px; border: none; background: none;
            cursor: pointer; font-weight: 600; color: #666;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            background: white; color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content { display: none; padding: 30px; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; }
        input, select, textarea {
            width: 100%; padding: 10px; border: 1px solid var(--color-border);
            border-radius: 5px; font-size: 14px;
        }

        .table-container { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: var(--color-primary-light); color: var(--color-primary); padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; white-space: nowrap; }
        tr:hover { background: #f9f9f9; }

        .status-badge {
            padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold;
        }
        .status-pendiente { background: #ffeeba; color: #856404; }
        .status-resuelto { background: #d4edda; color: #155724; }
        .status-cancelado { background: #f8d7da; color: #721c24; }

        .stats-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
            max-width: 400px;
        }
        .stat-card {
            padding: 15px 25px;
            border-radius: 10px;
            background: white;
            border-left: 8px solid var(--color-primary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .stat-card.blue { border-left-color: #3498db; background-color: #ebf5fb; }
        .stat-card.green { border-left-color: #27ae60; background-color: #eafaf1; }
        .stat-card.orange { border-left-color: #f39c12; background-color: #fef9e7; }
        .stat-card.red { border-left-color: #e74c3c; background-color: #fdedec; }
        .stat-card.purple { border-left-color: #8e44ad; background-color: #f5eef8; }
        .stat-card h3 { font-size: 14px; color: #000; text-transform: uppercase; font-weight: bold; }
        .stat-card .val { font-size: 24px; font-weight: bold; color: #000; }

        /* Modal */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content { background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; }

        .hidden { display: none; }
        
        .comparativo-box {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #eee;
            margin-top: 10px;
            font-size: 13px;
        }
        .comparativo-box strong { color: var(--color-primary); }

        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.8); display: none; align-items: center;
            justify-content: center; z-index: 2000; flex-direction: column;
        }
        .spinner {
            border: 4px solid #f3f3f3; border-top: 4px solid var(--color-primary);
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loading" class="loading-overlay">
    <div class="spinner"></div>
    <p>Sincronizando con la nube...</p>
</div>

<div class="container">
    <header>
        <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 10px;">
            <img src="data:image/jpeg;base64,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" style="height: 80px; background: white; padding: 5px; border-radius: 8px;">
            <div>
                <h1 style="margin:0;">Gestor de Cheques</h1>
                <p style="margin:0; opacity: 0.9;">Cloud Edition</p>
            </div>
        </div>
    </header>

    <div class="excel-controls">
        <button class="btn btn-primary" onclick="cargarDesdeNube()">
            <i class="fas fa-sync"></i> Sincronizar Nube
        </button>
        <button class="btn btn-success" onclick="exportarExcel()">
            <i class="fas fa-file-excel"></i> Excel
        </button>
        <button class="btn btn-danger" onclick="exportarPDF()">
            <i class="fas fa-file-pdf"></i> PDF
        </button>
        <span id="file-info" style="font-size: 14px; color: #666;">Estado: Conectado a la nube</span>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab(event, 'registro')">游닇 Registro</button>
        <button class="tab-btn" onclick="openTab(event, 'busqueda')">游댌 B칰squeda y Edici칩n</button>
        <button class="tab-btn" onclick="openTab(event, 'estadisticas')">游늵 Estad칤sticas</button>
    </div>

    <!-- TAB REGISTRO -->
    <div id="registro" class="tab-content active">
        <form id="form-cheque" onsubmit="registrarCheque(event)" style="max-width: 1000px; margin: 0 auto;">
            <div class="form-grid">
                <div class="form-group">
                    <label>Cliente *</label>
                    <input type="text" id="cliente" required>
                </div>
                <div class="form-group">
                    <label>RUT *</label>
                    <input type="text" id="rut" required>
                </div>
                <div class="form-group">
                    <label>N춿 Cheque *</label>
                    <input type="text" id="numeroCheque" required>
                </div>
                <div class="form-group">
                    <label>Fecha Cheque *</label>
                    <input type="date" id="fechaCheque" required>
                </div>
                <div class="form-group">
                    <label>Monto *</label>
                    <input type="number" id="monto" required>
                </div>
                <div class="form-group">
                    <label>Motivo *</label>
                    <select id="motivo" required>
                        <option value="">Seleccione...</option>
                        <option value="Cuenta cerrada">Cuenta cerrada</option>
                        <option value="Firma Disconforme">Firma Disconforme</option>
                        <option value="Cheque caduco">Cheque caduco</option>
                        <option value="Cheque enmendado">Cheque enmendado</option>
                        <option value="Orden de no pago">Orden de no pago</option>
                        <option value="Falta de fondos">Falta de fondos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha Rechazo *</label>
                    <input type="date" id="fechaRechazo" required>
                </div>

                <div class="form-group">
                    <label>Estado *</label>
                    <select id="estado" required>
                        <option value="Pendiente">Pendiente</option>
                        <option value="Resuelto">Resuelto</option>
                        <option value="Cancelado">Cancelado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Imagen del Cheque</label>
                    <input type="file" id="imagenCheque" accept="image/*">
                </div>
            </div>
            <div class="form-group">
                <label>Observaciones</label>
                <textarea id="observaciones" rows="3"></textarea>
            </div>
            <button type="submit" class="btn btn-success" style="width: 100%; justify-content: center;">
                <i class="fas fa-cloud-upload-alt"></i> Registrar y Guardar en la Nube
            </button>
        </form>
    </div>

    <!-- TAB B칔SQUEDA -->
    <div id="busqueda" class="tab-content">
        <div class="form-grid" style="margin-bottom: 15px;">
            <div class="form-group">
                <label>B칰squeda General</label>
                <input type="text" id="search-input" placeholder="Cliente, RUT, n칰mero o monto..." onkeyup="filtrarCheques()">
            </div>
            <div class="form-group">
                <label>Filtrar por Fecha Regularizaci칩n</label>
                <input type="date" id="filter-regularizacion" onchange="filtrarCheques()">
            </div>
            <div class="form-group" style="display: flex; align-items: center; gap: 10px; padding-top: 25px;">
                <input type="checkbox" id="filter-30days" onchange="filtrarCheques()" style="width: auto;">
                <label style="margin-bottom: 0; color: var(--color-danger);">Solo > 30 d칤as</label>
            </div>
        </div>
        <div class="table-container">
            <table id="tabla-cheques">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>RUT</th>
                        <th>N춿 Cheque</th>
                        <th>Fecha Cheque</th>
                        <th>Monto</th>
                        <th>Motivo</th>
                        <th>Fecha Rechazo</th>
                        <th>Fecha Regularizado.</th>
                        <th>D칤as Trans.</th>
                        <th>Obs.</th>
                        <th>Estado</th>
                        <th>Imagen</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tbody-cheques">
                </tbody>
            </table>
        </div>
    </div>

    <!-- TAB ESTAD칈STICAS -->
    <div id="estadisticas" class="tab-content">
        <!-- Filtros de Estad칤sticas -->
        <div class="form-grid" style="margin-bottom: 25px; background: #f1f1f1; padding: 20px; border-radius: 10px;">
            <div class="form-group">
                <label>Filtrar por Estado</label>
                <select id="stats-filter-estado" onchange="actualizarEstadisticas()">
                    <option value="Todos">Todos los Estados</option>
                    <option value="Pendiente">Pendiente</option>
                    <option value="Resuelto">Resuelto</option>
                    <option value="Cancelado">Cancelado</option>
                </select>
            </div>
            <div class="form-group">
                <label>Filtrar por Cliente</label>
                <select id="stats-filter-cliente" onchange="actualizarEstadisticas()">
                    <option value="Todos">Todos los Clientes</option>
                </select>
            </div>
            <div class="form-group">
                <label>Filtrar por Motivo</label>
                <select id="stats-filter-motivo" onchange="actualizarEstadisticas()">
                    <option value="Todos">Todos los Motivos</option>
                    <option value="Cuenta cerrada">Cuenta cerrada</option>
                    <option value="Firma Disconforme">Firma Disconforme</option>
                    <option value="Cheque caduco">Cheque caduco</option>
                    <option value="Cheque enmendado">Cheque enmendado</option>
                    <option value="Orden de no pago">Orden de no pago</option>
                    <option value="Falta de fondos">Falta de fondos</option>
                </select>
            </div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 20px;">
            <!-- Resumen General -->
            <div class="stats-grid" id="stats-container" style="max-width: 100%; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <!-- Stats din치micos -->
            </div>
            
            <!-- An치lisis Detallado -->
            <div id="analisis-detallado" style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-top: 4px solid var(--color-primary);">
                <h3 style="margin-bottom: 20px; color: #000; font-size: 18px; font-weight: bold; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                    <i class="fas fa-user-clock"></i> An치lisis de Reposici칩n y Desempe침o
                </h3>
                <div id="detalle-cliente-content" class="form-grid">
                    <!-- Contenido din치mico del an치lisis -->
                    <p style="color: #666; font-style: italic;">Seleccione un cliente para ver el an치lisis detallado de tiempos de reposici칩n.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL EDICI칍N -->
<div id="editModal" class="modal">
    <div class="modal-content">
        <h2 style="margin-bottom: 20px; color: var(--color-primary);">Editar Cheque</h2>
        <form onsubmit="guardarEdicion(event)">
            <input type="hidden" id="edit-id">
            <div class="form-grid">
                <div class="form-group">
                    <label>Estado</label>
                    <select id="edit-estado">
                        <option value="Pendiente">Pendiente</option>
                        <option value="Resuelto">Resuelto</option>
                        <option value="Cancelado">Cancelado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Motivo</label>
                    <select id="edit-motivo">
                        <option value="Cuenta cerrada">Cuenta cerrada</option>
                        <option value="Firma Disconforme">Firma Disconforme</option>
                        <option value="Cheque caduco">Cheque caduco</option>
                        <option value="Cheque enmendado">Cheque enmendado</option>
                        <option value="Orden de no pago">Orden de no pago</option>
                        <option value="Falta de fondos">Falta de fondos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha Rechazo</label>
                    <input type="date" id="edit-fechaRechazo" onchange="calcularComparativo()">
                </div>
                <div class="form-group">
                    <label>Fecha Regularizaci칩n</label>
                    <input type="date" id="edit-fechaRegularizacion" onchange="calcularComparativo()">
                </div>
            </div>
            
            <div id="comparativo-resultado" class="comparativo-box">
                D칤as transcurridos: <strong>-</strong>
            </div>

            <div class="form-group" style="margin-top: 15px;">
                <label>Observaciones</label>
                <textarea id="edit-observaciones" rows="4"></textarea>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button type="submit" class="btn btn-success" style="flex: 1;">Guardar en Nube</button>
                <button type="button" class="btn btn-danger" onclick="cerrarModal()" style="flex: 1;">Cancelar</button>
            </div>
        </form>
    </div>
</div>

<!-- MODAL IMAGEN -->
<div id="imageModal" class="modal">
    <div class="modal-content" style="max-width: 800px; text-align: center;">
        <h2 style="margin-bottom: 20px; color: var(--color-primary);">Imagen del Cheque</h2>
        <img id="img-preview" src="" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
        <div style="margin-top: 20px;">
            <button type="button" class="btn btn-danger" onclick="cerrarModal()" style="width: 100%;">Cerrar</button>
        </div>
    </div>
</div>

<script>
    // CONFIGURACI칍N DE LA NUBE
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxdfEPB4ybESUHg1iEgrB9kgCye5P_bM9sI0PZQOYdCVxj71V-axkFD35QAePO9mBr0jA/exec";

    let cheques = [];
    let myChart = null;

    // Al cargar la p치gina, traer datos de la nube
    window.onload = function() {
        cargarDesdeNube();
    };

    function showLoading(show) {
        document.getElementById('loading').style.display = show ? 'flex' : 'none';
    }

    async function cargarDesdeNube() {
        showLoading(true);
        try {
            const response = await fetch(WEB_APP_URL);
            const data = await response.json();
            
            // Normalizar datos recibidos con b칰squeda flexible de llaves
            cheques = data.map(c => {
                const getVal = (names) => {
                    for (let name of names) {
                        if (c[name] !== undefined && c[name] !== null) return c[name];
                    }
                    return '';
                };

                // Funci칩n para limpiar fechas (quitar hora si existe)
                const cleanDate = (val) => {
                    if (!val) return '';
                    if (typeof val === 'string' && val.includes('T')) return val.split('T')[0];
                    return val;
                };

                return {
                    id: getVal(['ID', 'id', 'Id']),
                    cliente: getVal(['Cliente', 'cliente', 'CLIENTE']),
                    rut: getVal(['RUT', 'rut', 'Rut']),
                    numeroCheque: getVal(['NumeroCheque', 'numeroCheque', 'N춿 Cheque', 'N춿Cheque', 'numero']),
                    fechaCheque: cleanDate(getVal(['FechaCheque', 'fechaCheque', 'Fecha Cheque'])),
                    monto: parseFloat(String(getVal(['Monto', 'monto', 'MONTO'])).replace(/[^0-9.-]+/g,"")) || 0,
                    motivo: getVal(['Motivo', 'motivo', 'MOTIVO']),
                    estado: getVal(['Estado', 'estado', 'ESTADO']) || 'Pendiente',
                    fechaRechazo: cleanDate(getVal(['FechaRechazo', 'fechaRechazo', 'Fecha Rechazo'])),
                    fechaRegularizacion: cleanDate(getVal(['FechaRegularizacion', 'fechaRegularizacion', 'Fecha Regularizacion'])),
                    observaciones: getVal(['Observaciones', 'observaciones', 'OBSERVACIONES']),
                    fechaRegistro: cleanDate(getVal(['FechaRegistro', 'fechaRegistro', 'Fecha Registro'])),
                    imagen: getVal(['Imagen', 'imagen', 'IMAGEN'])
                };
            });

            actualizarVistas();
            console.log("Datos cargados:", cheques);
        } catch (error) {
            console.error("Error al cargar:", error);
            alert("Error al conectar con la nube. Revisa tu conexi칩n.");
        } finally {
            showLoading(false);
        }
    }

    async function registrarCheque(e) {
        e.preventDefault();
        
        const numeroCheque = document.getElementById('numeroCheque').value;
        const rut = document.getElementById('rut').value;

        // Validaci칩n de documento duplicado (Solo por n칰mero de cheque)
        const existe = cheques.find(c => c.numeroCheque == numeroCheque);
        if (existe) {
            const confirmar = confirm(`丘멆잺 El cheque N춿 ${numeroCheque} ya se encuentra registrado.\n\n쮻esea a침adirlo de todas maneras?`);
            if (!confirmar) return;
        }

        const imgInput = document.getElementById('imagenCheque');
        let imagenBase64 = "";
        if (imgInput.files && imgInput.files[0]) {
            const reader = new FileReader();
            imagenBase64 = await new Promise((resolve) => {
                reader.onload = (e) => resolve(e.target.result);
                reader.readAsDataURL(imgInput.files[0]);
            });
        }

        const nuevo = {
            cliente: document.getElementById('cliente').value,
            rut: rut,
            numeroCheque: numeroCheque,
            fechaCheque: document.getElementById('fechaCheque').value,
            monto: parseFloat(document.getElementById('monto').value),
            motivo: document.getElementById('motivo').value,
            fechaRechazo: document.getElementById('fechaRechazo').value,
            fechaRegularizacion: "",
            observaciones: document.getElementById('observaciones').value,
            estado: document.getElementById('estado').value,
            imagen: imagenBase64
        };

        showLoading(true);
        try {
            const response = await fetch(WEB_APP_URL, {
                method: 'POST',
                mode: 'no-cors', // Necesario para Google Apps Script
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(nuevo)
            });

            // Como usamos no-cors, no podemos leer la respuesta, pero asumimos 칠xito si no hay error
            alert("九 Registro enviado a la nube con 칠xito.");
            e.target.reset();
            await cargarDesdeNube(); // Recargar para ver el nuevo registro con su ID
        } catch (error) {
            console.error("Error al registrar:", error);
            alert("仇 Error al guardar en la nube.");
        } finally {
            showLoading(false);
        }
    }

    async function guardarEdicion(e) {
        e.preventDefault();
        const id = document.getElementById('edit-id').value;
        const editado = {
            id: id,
            action: 'edit',
            estado: document.getElementById('edit-estado').value,
            motivo: document.getElementById('edit-motivo').value,
            fechaRechazo: document.getElementById('edit-fechaRechazo').value,
            fechaRegularizacion: document.getElementById('edit-fechaRegularizacion').value,
            observaciones: document.getElementById('edit-observaciones').value
        };
        
        showLoading(true);
        try {
            await fetch(WEB_APP_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(editado)
            });
            
            cerrarModal();
            alert("九 Registro actualizado con 칠xito en la nube.");
            // Esperar un momento antes de recargar para dar tiempo a Google Sheets
            setTimeout(async () => {
                await cargarDesdeNube();
            }, 1500);
        } catch (error) {
            console.error("Error al editar:", error);
            alert("仇 Error al actualizar en la nube.");
        } finally {
            showLoading(false);
        }
    }

    function exportarExcel() {
        if (cheques.length === 0) return alert("No hay datos para exportar");
        const ws = XLSX.utils.json_to_sheet(cheques);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Respaldo");
        XLSX.writeFile(wb, "Respaldo_Cheques_Cloud.xlsx");
    }

    function exportarPDF() {
        if (cheques.length === 0) return alert("No hay datos para exportar");
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('l', 'mm', 'a4');
        
        doc.text("Reporte de Cheques Rechazados", 14, 15);
        
        const tableData = cheques.map(c => [
            c.id, c.cliente, c.rut, c.numeroCheque, 
            `$${c.monto.toLocaleString()}`, c.motivo, 
            c.fechaRechazo, c.estado
        ]);

        doc.autoTable({
            head: [['ID', 'Cliente', 'RUT', 'N춿 Cheque', 'Monto', 'Motivo', 'Fecha Rechazo', 'Estado']],
            body: tableData,
            startY: 20,
            theme: 'grid',
            styles: { fontSize: 8 }
        });

        doc.save("Reporte_Cheques.pdf");
    }

    // L칩gica de UI (Mantenida del original)
    function openTab(evt, tabName) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        evt.currentTarget.classList.add('active');
        if(tabName === 'estadisticas') actualizarEstadisticas();
    }

    function calcularDias(fRechazo, fRegularizacion) {
        if (!fRechazo) return '-';
        const d1 = new Date(fRechazo);
        const d2 = fRegularizacion ? new Date(fRegularizacion) : new Date();
        
        if (isNaN(d1.getTime())) return '-';
        
        const diffTime = d2 - d1;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        return diffDays >= 0 ? diffDays : 0;
    }

    function actualizarVistas() {
        renderizarTabla(cheques);
        poblarFiltroClientes();
        actualizarEstadisticas();
    }    function renderizarTabla(datos) {
        const tbody = document.getElementById('tbody-cheques');
        tbody.innerHTML = '';
        
        datos.forEach(c => {
            // Normalizaci칩n de campos para asegurar que coincidan con los encabezados de la hoja
            const id = c.id || c["ID"] || "-";
            const cliente = c.cliente || c["Cliente"] || "-";
            const rut = c.rut || c["RUT"] || "-";
            const numCheque = c.numeroCheque || c["N춿 Cheque"] || "-";
            const fechaCheque = c.fechaCheque || c["Fecha Cheque"] || "-";
            const monto = c.monto || c["Monto"] || 0;
            const motivo = c.motivo || c["Motivo"] || "-";
            const fechaRechazo = c.fechaRechazo || c["Fecha Rechazo"] || "-";
            const fechaReg = c.fechaRegularizacion || c["Fecha Reg."] || c["Fecha Regularizaci칩n"] || "-";
            const obs = c.observaciones || c["Obs."] || c["Observaciones"] || "-";
            const estado = c.estado || c["Estado"] || "Pendiente";
            const imagen = c.imagen || c["Imagen"] || "";

            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${id}</td>
                <td>${cliente}</td>
                <td>${rut}</td>
                <td>${numCheque}</td>
                <td>${fechaCheque}</td>
                <td>$${Number(monto).toLocaleString()}</td>
                <td>${motivo}</td>
                <td>${fechaRechazo}</td>
                <td>${fechaReg}</td>
                <td style="${(typeof calcularDias(fechaRechazo, fechaReg) === 'number' && calcularDias(fechaRechazo, fechaReg) > 30) ? 'color: var(--color-danger); font-weight: bold;' : ''}">
                    ${calcularDias(fechaRechazo, fechaReg)}
                </td>
                <td title="${obs}">${obs.length > 15 ? obs.substring(0, 15) + '...' : obs}</td>
                <td><span class="status-badge status-${estado.toLowerCase()}">${estado}</span></td>
                <td>
                    ${imagen ? `<img src="${imagen}" onclick="verImagen('${imagen}')" style="width: 40px; height: 30px; object-fit: cover; border-radius: 4px; cursor: pointer; border: 1px solid #ddd;" title="Click para ampliar">` : '-'}
                </td>
                <td>
                    <button class="btn btn-warning btn-sm" onclick="abrirEdicion('${id}')" title="Editar"><i class="fas fa-edit"></i></button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function filtrarCheques() {
        const term = document.getElementById('search-input').value.toLowerCase();
        const filterDate = document.getElementById('filter-regularizacion').value;
        const filter30Days = document.getElementById('filter-30days').checked;
        
        const filtered = cheques.filter(c => {
            const matchesTerm = (c.cliente || '').toLowerCase().includes(term) || 
                               (c.rut || '').toLowerCase().includes(term) || 
                               (c.numeroCheque || '').toString().includes(term);
            const matchesDate = !filterDate || c.fechaRegularizacion === filterDate;
            const dias = calcularDias(c.fechaRechazo, c.fechaRegularizacion);
            const matches30Days = !filter30Days || (typeof dias === 'number' && dias > 30);
            return matchesTerm && matchesDate && matches30Days;
        });
        
        renderizarTabla(filtered);
    }

    function abrirEdicion(id) {
        const c = cheques.find(x => x.id == id);
        if(!c) return;
        document.getElementById('edit-id').value = c.id;
        document.getElementById('edit-estado').value = c.estado;
        document.getElementById('edit-motivo').value = c.motivo;
        document.getElementById('edit-fechaRechazo').value = c.fechaRechazo;
        document.getElementById('edit-fechaRegularizacion').value = c.fechaRegularizacion;
        document.getElementById('edit-observaciones').value = c.observaciones || c["Obs."] || c["Observaciones"] || "";
        document.getElementById('editModal').style.display = 'flex';
        calcularComparativo();
    }

    function cerrarModal() { 
        document.getElementById('editModal').style.display = 'none'; 
        document.getElementById('imageModal').style.display = 'none';
    }

    function verImagen(src) {
        document.getElementById('img-preview').src = src;
        document.getElementById('imageModal').style.display = 'flex';
    }

    function calcularComparativo() {
        const fRechazo = document.getElementById('edit-fechaRechazo').value;
        const fRegularizacion = document.getElementById('edit-fechaRegularizacion').value;
        const resDiv = document.getElementById('comparativo-resultado');
        if (fRechazo && fRegularizacion) {
            const d1 = new Date(fRechazo);
            const d2 = new Date(fRegularizacion);
            const diffTime = d2 - d1;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            const color = diffDays > 30 ? 'var(--color-danger)' : 'var(--color-primary)';
            resDiv.innerHTML = `D칤as transcurridos: <strong style="color: ${color}">${diffDays}</strong>`;
        } else {
            resDiv.innerHTML = "D칤as transcurridos: <strong>-</strong>";
        }
    }

    function poblarFiltroClientes() {
        const select = document.getElementById('stats-filter-cliente');
        if (!select) return;
        const valorActual = select.value;
        const clientes = [...new Set(cheques.map(c => c.cliente))].sort();
        select.innerHTML = '<option value="Todos">Todos los Clientes</option>';
        clientes.forEach(cli => {
            if (cli) {
                const opt = document.createElement('option');
                opt.value = cli;
                opt.textContent = cli;
                select.appendChild(opt);
            }
        });
        select.value = valorActual;
    }

    function actualizarEstadisticas() {
        const fEstado = document.getElementById('stats-filter-estado').value;
        const fCliente = document.getElementById('stats-filter-cliente').value;
        const fMotivo = document.getElementById('stats-filter-motivo').value;

        const filtrados = cheques.filter(c => {
            const matchEstado = fEstado === 'Todos' || c.estado === fEstado;
            const matchCliente = fCliente === 'Todos' || c.cliente === fCliente;
            const matchMotivo = fMotivo === 'Todos' || c.motivo === fMotivo;
            return matchEstado && matchCliente && matchMotivo;
        });

        const total = filtrados.length;
        const monto = filtrados.reduce((a, b) => a + b.monto, 0);
        const pendientesList = filtrados.filter(c => c.estado === 'Pendiente');
        const pendientes = pendientesList.length;
        const montoPendiente = pendientesList.reduce((a, b) => a + b.monto, 0);
        const resueltosList = filtrados.filter(c => c.estado === 'Resuelto');
        const resueltos = resueltosList.length;
        const montoRecuperado = resueltosList.reduce((a, b) => a + b.monto, 0);
        
        const cheques30 = filtrados.filter(c => {
            const dias = calcularDias(c.fechaRechazo, c.fechaRegularizacion);
            return typeof dias === 'number' && dias > 30;
        });

        const statsContainer = document.getElementById('stats-container');
        if(statsContainer) {
            statsContainer.innerHTML = `
                <div class="stat-card blue"><h3>Total Filtrados</h3><div class="val">${total}</div></div>
                <div class="stat-card blue"><h3>Monto Total</h3><div class="val">$${monto.toLocaleString()}</div></div>
                <div class="stat-card orange"><h3>Pendientes</h3><div class="val">${pendientes}</div></div>
                <div class="stat-card orange"><h3>Monto Pendiente</h3><div class="val">$${montoPendiente.toLocaleString()}</div></div>
                <div class="stat-card green"><h3>Resueltos</h3><div class="val">${resueltos}</div></div>
                <div class="stat-card green"><h3>Monto Recuperado</h3><div class="val">$${montoRecuperado.toLocaleString()}</div></div>
                <div class="stat-card red"><h3>Cheques > 30 D칤as</h3><div class="val">${cheques30.length}</div></div>
            `;
        }

        // An치lisis Detallado por Cliente
        const detalleContent = document.getElementById('detalle-cliente-content');
        if (detalleContent) {
            if (fCliente === 'Todos') {
                detalleContent.innerHTML = '<p style="color: #666; font-style: italic; grid-column: 1/-1;">Seleccione un cliente espec칤fico para ver el an치lisis detallado de tiempos de reposici칩n.</p>';
            } else {
                // Calcular tiempos de reposici칩n para el cliente seleccionado
                const tiempos = resueltosList
                    .map(c => calcularDias(c.fechaRechazo, c.fechaRegularizacion))
                    .filter(d => typeof d === 'number');
                
                const promedio = tiempos.length > 0 ? (tiempos.reduce((a, b) => a + b, 0) / tiempos.length).toFixed(1) : '-';
                const minimo = tiempos.length > 0 ? Math.min(...tiempos) : '-';
                const maximo = tiempos.length > 0 ? Math.max(...tiempos) : '-';
                
                const efectividad = total > 0 ? ((resueltos / total) * 100).toFixed(1) : 0;

                detalleContent.innerHTML = `
                    <div class="stat-card purple">
                        <h3>Tiempo Promedio Reposici칩n</h3>
                        <div class="val">${promedio} d칤as</div>
                    </div>
                    <div class="stat-card blue">
                        <h3>Reposici칩n m치s R치pida</h3>
                        <div class="val">${minimo} d칤as</div>
                    </div>
                    <div class="stat-card red">
                        <h3>Reposici칩n m치s Lenta</h3>
                        <div class="val">${maximo} d칤as</div>
                    </div>
                    <div class="stat-card green">
                        <h3>Tasa de Recuperaci칩n</h3>
                        <div class="val">${efectividad}%</div>
                    </div>
                    <div style="grid-column: 1/-1; margin-top: 15px; padding: 15px; background: #f9f9f9; border-radius: 8px; border: 1px solid #eee;">
                        <h4 style="margin-bottom: 10px; color: var(--color-primary);">Resumen de Desempe침o - ${fCliente}</h4>
                        <p>De un total de <strong>${total}</strong> cheques registrados, el cliente ha regularizado <strong>${resueltos}</strong>. 
                        Su tiempo de respuesta promedio es de <strong>${promedio} d칤as</strong>. 
                        ${promedio > 30 ? '<br><span style="color: var(--color-danger); font-weight: bold;">丘멆잺 Atenci칩n: El promedio de reposici칩n supera los 30 d칤as.</span>' : ''}</p>
                    </div>
                `;
            }
        }
    }

    function actualizarGrafica(pendientes) {
        // Funci칩n desactivada: reemplazada por An치lisis Detallado por Cliente
    }
</script>

</body>
</html>
